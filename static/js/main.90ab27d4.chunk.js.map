{"version":3,"sources":["getWeb3.js","components/Navbar.js","components/Content.js","dai.png","App.js","serviceWorker.js","index.js"],"names":["getWeb3","Promise","resolve","reject","window","addEventListener","a","ethereum","web3","Web3","enable","console","log","provider","providers","HttpProvider","NavbarCustom","accounts","Navbar","collapseOnSelect","expand","bg","variant","fixed","Container","Brand","href","Toggle","Collapse","className","Text","Content","daiBalance","bibscoinBalance","bibsStakingBalance","setDaiInput","stake","unstake","issueReward","allowance","allow","mintDai","style","backgroundColor","borderRadius","width","padding","Button","onClick","Row","Form","Label","column","lg","src","height","alt","marginTop","Col","md","Control","placeholder","type","ref","input","utils","fromWei","App","useState","setWeb3","setAccounts","dai","setDai","setDaiBalance","daiInput","setBibscoinBalance","bibsStaking","setBibsStaking","setBibsStakingBalance","setAllowance","useEffect","init","eth","handleRevert","getAccounts","on","location","reload","_chainId","net","getId","networkId","alert","daiData","Dai","networks","Contract","abi","address","methods","balanceOf","call","bibscoinData","Bibscoin","bibscoin","bibsStakingData","BibsStaking","stakingBalance","_address","then","num","Number","subscribe","err","res","error","events","Staked","fromBlock","event","returnValues","amount","message","Unstaked","RewardIssued","Transfer","value","toString","approve","send","from","status","daiAmount","toWei","mint","minHeight","paddingTop","Spinner","animation","marginBottom","Boolean","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"w9xuBAqCeA,EAnCC,kBACd,IAAIC,SAAQ,SAACC,EAASC,GAEpBC,OAAOC,iBAAiB,OAAxB,sBAAgC,kCAAAC,EAAA,0DAE1BF,OAAOG,SAFmB,wBAGtBC,EAAO,IAAIC,IAAKL,OAAOG,UAHD,kBAMpBH,OAAOG,SAASG,SANI,OAQ1BR,EAAQM,GARkB,gDAU1BL,EAAO,EAAD,IAVoB,gCAcrBC,OAAOI,MAERA,EAAOJ,OAAOI,KACpBG,QAAQC,IAAI,2BACZV,EAAQM,KAIFK,EAAW,IAAIJ,IAAKK,UAAUC,aAClC,yBAEIP,EAAO,IAAIC,IAAKI,GACtBF,QAAQC,IAAI,gDACZV,EAAQM,IA3BoB,8D,wBCYrBQ,EAdM,SAAC,GAAD,IAAEC,EAAF,EAAEA,SAAF,OACjB,kBAACC,EAAA,EAAD,CAAQC,kBAAgB,EAACC,OAAO,KAAKC,GAAG,OAAOC,QAAQ,OAAOC,MAAM,OAClE,kBAACC,EAAA,EAAD,KACA,kBAACN,EAAA,EAAOO,MAAR,CAAcC,KAAK,SAAnB,eACA,kBAACR,EAAA,EAAOS,OAAR,MACA,kBAACT,EAAA,EAAOU,SAAR,CAAiBC,UAAU,uBACzB,kBAACX,EAAA,EAAOY,KAAR,KACgB,OAAbb,GAAqBA,EAAS,Q,gCC6B1Bc,EAnCC,SAAC,GAAD,IAAGvB,EAAH,EAAGA,KAAMwB,EAAT,EAASA,WAAYC,EAArB,EAAqBA,gBAAiBC,EAAtC,EAAsCA,mBAAoBC,EAA1D,EAA0DA,YAAaC,EAAvE,EAAuEA,MAAOC,EAA9E,EAA8EA,QAASC,EAAvF,EAAuFA,YAAaC,EAApG,EAAoGA,UAAWC,EAA/G,EAA+GA,MAAOC,EAAtH,EAAsHA,QAAtH,OACZ,kBAACjB,EAAA,EAAD,CAAWkB,MAAO,CAAEC,gBAAiB,QAASC,aAAc,GAAIC,MAAO,OAAQC,QAAS,KAAxF,cAEI,6BAAM,6BACJP,EAEA,wCAAKP,GAAc,EACb,kBAACe,EAAA,EAAD,CAAQC,QAASP,EAASnB,QAAQ,UAAUO,UAAU,QAAtD,YACF,oCACE,kBAACoB,EAAA,EAAD,CAAKpB,UAAU,6BACX,kBAACqB,EAAA,EAAKC,MAAN,CAAYC,QAAM,EAACC,GAAI,GACnB,yBAAKC,ICfd,qgHDewBC,OAAO,KAAKC,IAAI,GAAGd,MAAO,CAAEe,WAAY,MAE3D,kBAACC,EAAA,EAAD,CAAKC,GAAG,QACJ,kBAACT,EAAA,EAAKU,QAAN,CAAcC,YAAY,gBAAgBC,KAAK,OAAOC,IAAK,SAAAC,GAAK,OAAI7B,EAAY6B,OAEpF,kBAACd,EAAA,EAAKC,MAAN,CAAYC,QAAM,EAACC,GAAI,GAAvB,cAAsC7C,GAAQA,EAAKyD,MAAMC,QAAQlC,EAAY,WAEjF,6BACA,kBAACiB,EAAA,EAAD,CAAKpB,UAAU,6BACX,kBAAC6B,EAAA,EAAD,CAAKC,GAAG,QAAO,kBAACZ,EAAA,EAAD,CAAQC,QAASZ,EAAOd,QAAQ,UAAUO,UAAU,QAApD,UACf,kBAAC6B,EAAA,EAAD,CAAKC,GAAG,QAAO,kBAACZ,EAAA,EAAD,CAAQC,QAASX,EAASf,QAAQ,SAASO,UAAU,QAArD,aAEnB,6BACA,kBAACoB,EAAA,EAAD,CAAKpB,UAAU,6BACX,kBAAC6B,EAAA,EAAD,CAAKC,GAAG,QAAR,yBAAsCnD,GAAQA,EAAKyD,MAAMC,QAAQhC,EAAoB,SAArF,QACA,kBAACwB,EAAA,EAAD,CAAKC,GAAG,QAAR,yBAAsCnD,GAAQA,EAAKyD,MAAMC,QAAQjC,EAAiB,SAAlF,UAEJ,6BACA,kBAACc,EAAA,EAAD,CAAQC,QAASV,EAAahB,QAAQ,UAAUO,UAAU,QAA1D,mBAxBJ,kBAACkB,EAAA,EAAD,CAAQC,QAASR,EAAOlB,QAAQ,UAAUO,UAAU,QAApD,Y,QEmNGsC,G,MAhNH,WACV,MAAwBC,mBAAS,MAAjC,mBAAO5D,EAAP,KAAa6D,EAAb,KACA,EAAgCD,mBAAS,MAAzC,mBAAOnD,EAAP,KAAiBqD,EAAjB,KACA,EAAsBF,mBAAS,MAA/B,mBAAOG,EAAP,KAAYC,EAAZ,KACA,EAAoCJ,mBAAS,MAA7C,mBAAOpC,EAAP,KAAmByC,EAAnB,KACA,EAAgCL,mBAAS,MAAzC,mBAAOM,EAAP,KAAiBvC,EAAjB,KACA,EAA8CiC,mBAAS,MAAvD,mBAAOnC,EAAP,KAAwB0C,EAAxB,KACA,EAAsCP,mBAAS,MAA/C,mBAAOQ,EAAP,KAAoBC,EAApB,KACA,EAAoDT,mBAAS,MAA7D,mBAAOlC,EAAP,KAA2B4C,EAA3B,KACA,EAAkCV,oBAAS,GAA3C,mBAAO7B,EAAP,KAAkBwC,EAAlB,KAEAC,qBAAU,WACR,IAAMC,EAAI,uCAAG,kDAAA3E,EAAA,+EAGUN,IAHV,cAGHQ,EAHG,QAKJ0E,IAAIC,cAAe,EALf,SAOc3E,EAAK0E,IAAIE,cAPvB,cAOHnE,EAPG,OAWLb,OAAOG,WACTH,OAAOG,SAAS8E,GAAG,mBAAmB,SAACpE,GACrCqD,EAAY,CAAErD,aACdb,OAAOkF,SAASC,YAGlBnF,OAAOG,SAAS8E,GAAG,gBAAgB,SAACG,GAAD,OAAcpF,OAAOkF,SAASC,aAjB1D,UAqBe/E,EAAK0E,IAAIO,IAAIC,QArB5B,WAuBS,QAFZC,EArBG,SAuB+B,KAAdA,EAvBjB,wBAwBPC,MAAM,sCAxBC,kCA6BHC,EAAUC,EAAIC,SAASJ,GACvBpB,EAAM,IAAI/D,EAAK0E,IAAIc,SAASF,EAAIG,IAAKJ,GAAWA,EAAQK,SAC9D1B,EAAOD,GA/BE,UAgCcA,EAAI4B,QAAQC,UAAUnF,EAAS,IAAIoF,OAhCjD,eAgCLrE,EAhCK,OAiCTyC,EAAczC,GAGRsE,EAAeC,EAASR,SAASJ,GACjCa,EAAW,IAAIhG,EAAK0E,IAAIc,SAASO,EAASN,IAAKK,GAAgBA,EAAaJ,SArCzE,UAsCmBM,EAASL,QAAQC,UAAUnF,EAAS,IAAIoF,OAtC3D,eAsCLpE,EAtCK,OAuCT0C,EAAmB1C,GAGbwE,EAAkBC,EAAYX,SAASJ,GACvCf,EAAc,IAAIpE,EAAK0E,IAAIc,SAASU,EAAYT,IAAKQ,GAAmBA,EAAgBP,SAC9FrB,EAAeD,GA5CN,UA6CsBA,EAAYuB,QAAQQ,eAAe1F,EAAS,IAAIoF,OA7CtE,eA6CLnE,EA7CK,OA8CT4C,EAAsB5C,GA9Cb,UAiDHqC,EAAI4B,QAAQ5D,UAAUtB,EAAS,GAAI2D,EAAYgC,UAAUP,OAAOQ,MAAK,SAAAC,GAAG,OAAI/B,EAA6B,IAAhBgC,OAAOD,OAjD7F,QAoDTtG,EAAK0E,IAAI8B,UAAU,kBAAnB,uCAAsC,WAAOC,EAAKC,GAAZ,SAAA5G,EAAA,yDAC/B2G,EAD+B,gCAE5B1C,EAAI4B,QAAQC,UAAUnF,EAAS,IAAIoF,OAAOQ,MAAK,SAACK,GAAD,OAASzC,EAAcyC,MAF1C,uBAG5BV,EAASL,QAAQC,UAAUnF,EAAS,IAAIoF,OAAOQ,MAAK,SAACK,GAAD,OAASvC,EAAmBuC,MAHpD,uBAI5BtC,EAAYuB,QAAQQ,eAAe1F,EAAS,IAAIoF,OAAOQ,MAAK,SAACK,GAAD,OAASpC,EAAsBoC,MAJ/D,2CAAtC,yDASA7C,EAAQ7D,GACR8D,EAAYrD,GA9DH,kDAiET2E,MAAM,0EACNjF,QAAQwG,MAAR,MAlES,0DAAH,qDAqEVlC,MACC,IAGHD,qBAAU,WACY,OAAhBJ,GAAiC,OAATpE,IAC1BoE,EAAYwC,OAAOC,OAAO,CAACC,UAAW,IACrCjC,GAAG,QAAQ,SAAAkC,GAAK,OAAI3B,MAAM,0BAAD,OAA2BpF,EAAKyD,MAAMC,QAAQqD,EAAMC,aAAaC,OAAQ,SAAzE,mBACzBpC,GAAG,SAAS,SAAA4B,GAAG,OAAIrB,MAAMqB,EAAIS,YAE9B9C,EAAYwC,OAAOO,SAAS,CAACL,UAAW,IACvCjC,GAAG,QAAQ,SAAAkC,GAAK,MAAkC,MAA9BA,EAAMC,aAAaC,QAAkB7B,MAAM,0BAAD,OAA2BpF,EAAKyD,MAAMC,QAAQqD,EAAMC,aAAaC,OAAQ,SAAzE,qBAC9DpC,GAAG,SAAS,SAAA4B,GAAG,OAAIrB,MAAMqB,EAAIS,YAE9B9C,EAAYwC,OAAOQ,aAAa,CAACN,UAAW,IAC3CjC,GAAG,QAAQ,SAAAkC,GAAK,OAAI3B,MAAM,0BAAD,OAA2BpF,EAAKyD,MAAMC,QAAQqD,EAAMC,aAAaC,OAAQ,SAAzE,oBACzBpC,GAAG,SAAS,SAAA4B,GAAG,OAAIrB,MAAMqB,EAAIS,eAE/B,CAAC9C,EAAapE,IAEjBwE,qBAAU,WACI,OAART,GAAyB,OAAT/D,GAClB+D,EAAI6C,OAAOS,SAAS,CAACP,UAAW,IAC/BjC,GAAG,QAAQ,SAAAkC,GAAK,OAAI3B,MAAM,0BAAD,OAA2BpF,EAAKyD,MAAMC,QAASqD,EAAMC,aAAaM,MAAOC,WAAY,SAArF,uBACzB1C,GAAG,SAAS,SAAA4B,GAAG,OAAIrB,MAAMqB,EAAIS,cAE/B,CAACnD,EAAK/D,IAGT,IAAMgC,EAAK,uCAAG,sBAAAlC,EAAA,sEACNiE,EAAI4B,QAAQ6B,QAAQpD,EAAYgC,UAAW,GAAGqB,KAAK,CAAEC,KAAMjH,EAAS,KAAM4F,MAAK,SAACK,GACpFnC,GAA4B,IAAfmC,EAAIiB,WAFP,2CAAH,qDAML/F,EAAK,uCAAG,4BAAA9B,EAAA,sEAEJ8H,EAAY5H,EAAKyD,MAAMoE,MAAM3D,EAASoD,MAAO,SAFzC,SAGJlD,EAAYuB,QAAQ/D,MAAMgG,GAAWH,KAAK,CAAEC,KAAMjH,EAAS,KAHvD,sDAMVN,QAAQC,IAAI,KAAM8G,SANR,wDAAH,qDAULrF,EAAO,uCAAG,4BAAA/B,EAAA,sEAqBN8H,EAAY5H,EAAKyD,MAAMoE,MAAM3D,EAASoD,MAAO,SArBvC,SAsBNlD,EAAYuB,QAAQ9D,QAAQ+F,GAAWH,KAAK,CAAEC,KAAMjH,EAAS,KAtBvD,sDAwBZN,QAAQC,IAAI,KAAM8G,SAxBN,wDAAH,qDA4BPpF,EAAW,uCAAG,sBAAAhC,EAAA,+EAEVsE,EAAYuB,QAAQ9D,QAAQ,GAAG4F,KAAK,CAAEC,KAAMjH,EAAS,KAF3C,sDAIhBN,QAAQC,IAAI,KAAM8G,SAJF,wDAAH,qDAQXjF,EAAO,uCAAG,sBAAAnC,EAAA,+EAENiE,EAAI4B,QAAQmC,KAAKrH,EAAS,GAAIT,EAAKyD,MAAMoE,MAAM,OAAQ,UAAUJ,KAAK,CAAEC,KAAMjH,EAAS,KAFjF,sDAIZN,QAAQC,IAAI,KAAM8G,SAJN,wDAAH,qDAgBb,OAAKlH,EASH,yBAAKqB,UAAU,MAAMa,MAAO,CAAEC,gBAAiB,UAAW4F,UAAW,UACnE,kBAAC,EAAD,CAAQtH,SAAUA,IAClB,yBAAKyB,MAAO,CAAE8F,WAAY,MACxB,kBAAC,EAAD,CACEhI,KAAMA,EACNwB,WAAYA,EACZC,gBAAiBA,EACjBC,mBAAoBA,EACpBC,YAAaA,EACbC,MAAOA,EACPC,QAASA,EACTC,YAAaA,EACbC,UAAWA,EACXC,MAAOA,EACPC,QAASA,MArBb,yBAAKZ,UAAU,MAAMa,MAAO,CAAEe,UAAW,KACvC,kBAACgF,EAAA,EAAD,CAASC,UAAU,SAASpH,QAAQ,OAAOoB,MAAO,CAAEiG,aAAc,MAClE,0ECtLYC,QACW,cAA7BxI,OAAOkF,SAASuD,UAEe,UAA7BzI,OAAOkF,SAASuD,UAEhBzI,OAAOkF,SAASuD,SAASC,MACvB,2DCZNC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMxC,MAAK,SAAAyC,GACjCA,EAAaC,kB","file":"static/js/main.90ab27d4.chunk.js","sourcesContent":["import Web3 from \"web3\";\n\nconst getWeb3 = () =>\n  new Promise((resolve, reject) => {\n    // Wait for loading completion to avoid race conditions with web3 injection timing.\n    window.addEventListener(\"load\", async () => {\n      // Modern dapp browsers...\n      if (window.ethereum) {\n        const web3 = new Web3(window.ethereum);\n        try {\n          // Request account access if needed\n          await window.ethereum.enable();\n          // Accounts now exposed\n          resolve(web3);\n        } catch (error) {\n          reject(error);\n        }\n      }\n      // Legacy dapp browsers...\n      else if (window.web3) {\n        // Use Mist/MetaMask's provider.\n        const web3 = window.web3;\n        console.log(\"Injected web3 detected.\");\n        resolve(web3);\n      }\n      // Fallback to localhost; use dev console port by default...\n      else {\n        const provider = new Web3.providers.HttpProvider(\n          \"http://127.0.0.1:8545\"\n        );\n        const web3 = new Web3(provider);\n        console.log(\"No web3 instance injected, using Local web3.\");\n        resolve(web3);\n      }\n    });\n  });\n\nexport default getWeb3;\n","import React from \"react\";\r\nimport {Navbar, Container} from 'react-bootstrap';\r\n\r\nconst NavbarCustom = ({accounts}) => (\r\n    <Navbar collapseOnSelect expand=\"lg\" bg=\"dark\" variant=\"dark\" fixed=\"top\">\r\n      <Container>\r\n      <Navbar.Brand href=\"#home\">StakingDAPP</Navbar.Brand>\r\n      <Navbar.Toggle />\r\n      <Navbar.Collapse className=\"justify-content-end\">\r\n        <Navbar.Text>\r\n          {accounts !== null && accounts[0]}\r\n        </Navbar.Text>\r\n      </Navbar.Collapse>\r\n      </Container>\r\n    </Navbar>\r\n);\r\n\r\nexport default NavbarCustom;","import React from \"react\";\r\nimport { Container, Row, Col, Form, Button } from 'react-bootstrap';\r\nimport dai from '../dai.png'\r\n\r\nconst Content = ({ web3, daiBalance, bibscoinBalance, bibsStakingBalance, setDaiInput, stake, unstake, issueReward, allowance, allow, mintDai}) => (\r\n    <Container style={{ backgroundColor: 'white', borderRadius: 20, width: \"80vh\", padding: 20 }}>\r\n        Staking DAI\r\n        <br /><br />\r\n        {!allowance ?\r\n            <Button onClick={allow} variant=\"primary\" className=\"mb-2\">Unlock</Button>\r\n        : <> { daiBalance <= 0 ?\r\n                <Button onClick={mintDai} variant=\"primary\" className=\"mb-2\">Mint Dai</Button>\r\n            : <>\r\n                <Row className=\"justify-content-md-center\">\r\n                    <Form.Label column lg={1}>\r\n                        <img src={dai} height='35' alt=\"\" style={{ marginTop: -5 }} />\r\n                    </Form.Label>\r\n                    <Col md=\"auto\">\r\n                        <Form.Control placeholder=\"Amount of DAI\" type=\"text\" ref={input => setDaiInput(input)} />\r\n                    </Col>\r\n                    <Form.Label column lg={3}>Available: {web3 && web3.utils.fromWei(daiBalance, 'Ether')}</Form.Label>\r\n                </Row>\r\n                <br />\r\n                <Row className=\"justify-content-md-center\">\r\n                    <Col md=\"auto\"><Button onClick={stake} variant=\"warning\" className=\"mb-2\">STAKE</Button></Col>\r\n                    <Col md=\"auto\"><Button onClick={unstake} variant=\"danger\" className=\"mb-2\">UNSTAKE</Button></Col>\r\n                </Row>\r\n                <br />\r\n                <Row className=\"justify-content-md-center\">\r\n                    <Col md=\"auto\">Your Staking Balance: {web3 && web3.utils.fromWei(bibsStakingBalance, 'Ether')} DAI</Col>\r\n                    <Col md=\"auto\">Your Rewards Balance: {web3 && web3.utils.fromWei(bibscoinBalance, 'Ether')} BIBS</Col>\r\n                </Row>\r\n                <br />\r\n                <Button onClick={issueReward} variant=\"success\" className=\"mb-2\">Claim Rewards</Button>\r\n            </>}\r\n        </>}\r\n    </Container>\r\n);\r\n\r\nexport default Content;","export default \"data:image/png;base64,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\"","import React, { useEffect, useState } from \"react\";\nimport Dai from \"./contracts/Dai.json\";\nimport Bibscoin from \"./contracts/Bibscoin.json\";\nimport BibsStaking from \"./contracts/BibsStaking.json\";\nimport getWeb3 from \"./getWeb3\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Navbar from \"./components/Navbar\";\nimport Content from \"./components/Content\";\nimport { Spinner } from 'react-bootstrap';\n\nimport \"./App.css\";\n\nconst App = () => {\n  const [web3, setWeb3] = useState(null);\n  const [accounts, setAccounts] = useState(null);\n  const [dai, setDai] = useState(null);\n  const [daiBalance, setDaiBalance] = useState(null);\n  const [daiInput, setDaiInput] = useState(null);\n  const [bibscoinBalance, setBibscoinBalance] = useState(null);\n  const [bibsStaking, setBibsStaking] = useState(null);\n  const [bibsStakingBalance, setBibsStakingBalance] = useState(null);\n  const [allowance, setAllowance] = useState(false)\n\n  useEffect(() => {\n    const init = async () => {\n      try {\n        // Get network provider and web3 instance.\n        const web3 = await getWeb3();\n\n        web3.eth.handleRevert = true;\n        // Use web3 to get the user's accounts.\n        const accounts = await web3.eth.getAccounts();\n\n        // web3.eth.handleRevert = true;\n\n        if (window.ethereum) {\n          window.ethereum.on('accountsChanged', (accounts) => {\n            setAccounts({ accounts });\n            window.location.reload();\n          });\n\n          window.ethereum.on('chainChanged', (_chainId) => window.location.reload());\n        }\n\n        // Get the contract instance.\n        const networkId = await web3.eth.net.getId();\n\n        if (networkId !== 1337 && networkId !== 42) {\n          alert(\"Please Switch to the Kovan Network\");\n          return;\n        }\n\n        // Load Dai\n        const daiData = Dai.networks[networkId];\n        const dai = new web3.eth.Contract(Dai.abi, daiData && daiData.address);\n        setDai(dai);\n        let daiBalance = await dai.methods.balanceOf(accounts[0]).call();\n        setDaiBalance(daiBalance);\n\n        // Load Bibscoin\n        const bibscoinData = Bibscoin.networks[networkId];\n        const bibscoin = new web3.eth.Contract(Bibscoin.abi, bibscoinData && bibscoinData.address);\n        let bibscoinBalance = await bibscoin.methods.balanceOf(accounts[0]).call();\n        setBibscoinBalance(bibscoinBalance);\n\n        // Load BibsStaking\n        const bibsStakingData = BibsStaking.networks[networkId];\n        const bibsStaking = new web3.eth.Contract(BibsStaking.abi, bibsStakingData && bibsStakingData.address);\n        setBibsStaking(bibsStaking);\n        let bibsStakingBalance = await bibsStaking.methods.stakingBalance(accounts[0]).call();\n        setBibsStakingBalance(bibsStakingBalance);\n\n        // Check the allowance\n        await dai.methods.allowance(accounts[0], bibsStaking._address).call().then(num => setAllowance(Number(num) !== 0))\n\n        // Subscribe to the contract states to update the front states\n        web3.eth.subscribe('newBlockHeaders', async (err, res) => {\n          if (!err) {\n            await dai.methods.balanceOf(accounts[0]).call().then((res) => setDaiBalance(res));\n            await bibscoin.methods.balanceOf(accounts[0]).call().then((res) => setBibscoinBalance(res));\n            await bibsStaking.methods.stakingBalance(accounts[0]).call().then((res) => setBibsStakingBalance(res));\n          }\n        });\n\n        // Set web3, accounts, and the contracts to the state, and then proceed\n        setWeb3(web3);\n        setAccounts(accounts);\n      } catch (error) {\n        // Catch any errors for any of the above operations.\n        alert(`Failed to load web3, accounts, or contract. Check console for details.`,);\n        console.error(error);\n      }\n    }\n    init();\n  }, []);\n\n  // EVENTS\n  useEffect(() => {\n    if (bibsStaking !== null && web3 !== null) {\n      bibsStaking.events.Staked({fromBlock: 0})\n      .on('data', event => alert(`Transaction Approuved: ${web3.utils.fromWei(event.returnValues.amount, 'Ether')} DAI staked`))\n      .on('error', err => alert(err.message))\n\n      bibsStaking.events.Unstaked({fromBlock: 0})\n      .on('data', event => event.returnValues.amount !== \"0\" && alert(`Transaction Approuved: ${web3.utils.fromWei(event.returnValues.amount, 'Ether')} DAI unstaked`))\n      .on('error', err => alert(err.message))\n  \n      bibsStaking.events.RewardIssued({fromBlock: 0})\n      .on('data', event => alert(`Transaction Approuved: ${web3.utils.fromWei(event.returnValues.amount, 'Ether')} BIBS issued`))\n      .on('error', err => alert(err.message))\n    }\n  }, [bibsStaking, web3])\n\n  useEffect(() => {\n    if (dai !== null && web3 !== null) {\n      dai.events.Transfer({fromBlock: 0})\n      .on('data', event => alert(`Transaction Approuved: ${web3.utils.fromWei((event.returnValues.value).toString(), 'Ether')} DAI transfered`))\n      .on('error', err => alert(err.message))\n    }\n  }, [dai, web3])\n  \n\n  const allow = async () => {\n    await dai.methods.approve(bibsStaking._address, -1).send({ from: accounts[0] }).then((res) => {\n      setAllowance(res.status === true);\n    });\n  }\n\n  const stake = async () => {\n    try {\n      const daiAmount = web3.utils.toWei(daiInput.value, 'Ether');\n      await bibsStaking.methods.stake(daiAmount).send({ from: accounts[0] });\n    }\n    catch (error) {\n      console.log(error.message);\n    }\n  };\n\n  const unstake = async () => {\n    // try {\n    //   const daiAmount = web3.utils.toWei(daiInput.value, 'Ether');\n    //   await bibsStaking.methods.unstake(daiAmount).send({ from: accounts[0] }, function (err) {\n    //     if (err) {\n    //       if (err.message.length < 100) {\n    //         alert(err.message)\n    //         window.location.reload();\n    //       } else {\n    //         alert(err.message.substring(149, 177));\n    //         window.location.reload();\n    //       }\n    //     } else {\n    //       alert(\"Transaction Approuved\");\n    //       window.location.reload();\n    //     }\n    //   })\n    // } catch (error) {\n    //   console.log(error.message);\n    // }\n    try {\n      const daiAmount = web3.utils.toWei(daiInput.value, 'Ether');\n      await bibsStaking.methods.unstake(daiAmount).send({ from: accounts[0] });\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n\n  const issueReward = async () => {\n    try {\n      await bibsStaking.methods.unstake(0).send({ from: accounts[0] })\n    } catch (error) {\n      console.log(error.message)\n    }\n  }\n\n  const mintDai = async () => {\n    try {\n      await dai.methods.mint(accounts[0], web3.utils.toWei(\"1000\", 'Ether')).send({ from: accounts[0] });\n    } catch (error) {\n      console.log(error.message)\n    }\n  }\n\n  // MESSAGES D'ERREURS, Capter seulement le petit message et changer les alert en modal jolies\n  // utiliser le vrai DAI 0x4f96fe3b7a6cf9725f59d353f723c1bdb64ca6aa\n\n  // Chainlink: DAI/ETH https://kovan.etherscan.io/address/0x22B58f1EbEDfCA50feF632bD73368b2FdA96D541\n\n  // deploiment sur githubpage et heroku\n  // Voir grille de notation\n\n  if (!web3) {\n    return (\n      <div className=\"App\" style={{ marginTop: 50 }}>\n        <Spinner animation=\"border\" variant=\"dark\" style={{ marginBottom: 20 }} />\n        <h3>Loading Web3, accounts, and contract...</h3>\n      </div>\n    )\n  }\n  return (\n    <div className=\"App\" style={{ backgroundColor: '#EFF0D1', minHeight: \"100vh\" }}>\n      <Navbar accounts={accounts} />\n      <div style={{ paddingTop: 100 }}>\n        <Content\n          web3={web3}\n          daiBalance={daiBalance}\n          bibscoinBalance={bibscoinBalance}\n          bibsStakingBalance={bibsStakingBalance}\n          setDaiInput={setDaiInput}\n          stake={stake}\n          unstake={unstake}\n          issueReward={issueReward}\n          allowance={allowance}\n          allow={allow}\n          mintDai={mintDai}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}